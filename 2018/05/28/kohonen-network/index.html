<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/><meta content="telephone=no" name="format-detection"/><meta name="description"/><title>Mạng Nơ-ron tự tổ chức (Mạng Kohonen) - Self Organising Map | Lương Quốc An</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"/><link rel="stylesheet" type="text/css" href="/css/highlight.css"/><link rel="stylesheet" type="text/css" href="/css/font.css"/><link rel="stylesheet" type="text/css" href="/css/noise.css"/><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"/><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"/></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a></nav><div class="container post-meta"><div class="post-time">2018-05-28</div></div></div><div class="container post-header"><h1>Mạng Nơ-ron tự tổ chức (Mạng Kohonen) - Self Organising Map</h1></div><div class="container post-content"><a id="more"></a>
<h2 id="Tong-quan"><a href="#Tong-quan" class="headerlink" title="Tổng quan"></a>Tổng quan</h2><p>Mạng Nơ-ron tự tổ chức (seft-organizing map), hay còn gọi là mạng Kohonen là một loại mạng nơ-ron nhân tạo được huấn luyện thông qua phương pháp học không giám sát. Khác với các mô hình mạng nơ-ron truyền thẳng hay mạng nơ-ron tích chập, mạng kohonen sử dụng cách học cạnh tranh (competitive learing) thay vì phương pháp sửa lỗi (error correction).<br>Mô hình này được đề xuất bởi Teuvo Kohonen vào những năm 1980 dựa trên một phần cách thức mà các tín hiệu được xử lý trong não bộ. Cũng giống với các mô hình nơ-ron khác, mạng Kohonen cũng cần trải qua quá trình huấn luyện. Tuy nhiên, như đã đề cập, phương pháp và ý tưởng của mạng Kohonen có nhiều sự khác biệt so với các mô hình mạng nơ-ron học theo phương pháp học có giám sát.<br>Mạng Kohonen với phương pháp học không giám sát được sử dụng hiệu quả trong các bài toán gom nhóm (clustering). Có thể nói mô hình này gần giống với phương pháp gom nhóm K-mean hơn là các mạng nơ-ron khác.</p>
<h2 id="Huan-luyen-cho-mang-Kohonen"><a href="#Huan-luyen-cho-mang-Kohonen" class="headerlink" title="Huấn luyện cho mạng Kohonen"></a>Huấn luyện cho mạng Kohonen</h2><p>Kiến trúc của một mạng Kohonen đơn giản bao gồm 2 lớp: lớp nhập và lớp xuất. Lớp nhập bao gồm các nút ứng với các đặc trưng của dữ liệu đầu vào. Nếu dữ liệu đầu vào là một vector có m đặc trưng thì lớp nhập sẽ có m nút tương ứng. Lớp xuất đại diện cho số lượng nhóm cần gom nhóm. Nếu bài toán yêu cầu phân loại các đối tượng thành 10 nhóm thì lớp xuất sẽ gồm 10 nút.</p>
<p>Kiến trúc mạng Kohonen</p>
<p>Các nút ở lớp nhập và lớp xuất được liên kết đầy đủ với nhau thông qua các trọng số w. Như vậy một nơ-ron ở đầu ra sẽ có m trọng số nối đến nó tương ứng với m đặc trưng của dữ liệu đầu vào. Các trọng số này đóng vai trò đại diện cho nhóm tương ứng với nơ-ron ở lớp xuất và có nhiệm vụ tính toán và phân loại đối tượng đầu vào sẽ vào lớp nào trong các nút ở đầu ra. Các giá trị trọng số w sẽ được khởi gán ngẫu nhiên khi khởi tạo mô hình.</p>
<h2 id="Qua-trinh-huan-luyen"><a href="#Qua-trinh-huan-luyen" class="headerlink" title="Quá trình huấn luyện"></a>Quá trình huấn luyện</h2><p>Với một mạng Kohonen có m đặc trưng đầu vào cần gom nhóm thành n nhóm đầu ra, ta gọi wij là trọng số nối giữa đầu vào thứ j và đầu ra thứ i. Một mẫu dữ liệu vào sẽ gồm m đặc trưng xj (j từ 1 đến m). Quá trình huấn luyện cho mạng kohonen như sau:</p>
<ul>
<li>Item Lấy một mẫu dữ liệu học đưa vào mô hình.</li>
<li>Item Với mỗi nút tại lớp ra, tính khoảng cách Euclide (hoặc một độ đo thích hợp khác) giữa vector đặc trưng đầu vào và vector trọng số nối với nut đó. Lấy nút có giá trị tính được nhỏ nhất, gọi là best matching unit.</li>
<li>Item Cập nhật trọng số gắn với nút đó: $W_{new} = W + \alpha <em> (X - W)$. Với $\alphaα$ là hệ số học, thể hiện cho mức độ cập nhật W sau mỗi lần lặp.
</em>Item Tiến hành lặp lại các bước trên cho mẫu dữ liệu mới cho đến khi đạt một số lần lặp nhất định.<br>Ta thấy rằng cách thức hoạt động của mô hình rất giống với thuật toán k-mean. Cứ mỗi mẫu dữ liệu đưa vào thì giá trị trọng số của nút gần nó nhất (best matching unit) sẽ được cập nhật lại theo kiểu kéo dần về phía của mẫu dữ liệu trong không gian biểu diễn. Như vậy sau nhiều mẫu dữ liệu được dùng để học thì giá trị trọng số của một nút đầu ra chính là đặc trưng trung bình của nút đó. Nếu một mẫu dữ liều mới cần phân loại được đưa vào, khoảng cách từ nó đến giá trị trung bình nào nhỏ nhất thì nó sẽ có nhiều khả năng thuộc nhóm đó.</li>
</ul>
<h2 id="Vi-du"><a href="#Vi-du" class="headerlink" title="Ví dụ"></a>Ví dụ</h2><p>Xét một tập dữ liệu gồm 8 mẫu (1,1), (1,2), (2,1), (2,2), (4,4), (4,5), (5,4), (5,5) như sau:</p>
<p>Yêu cầu đặt ra là sử dụng mạng Kohonen để phân tập dữ liệu này thành 2 nhóm. Truớc tiên ta cần xây dựng kiến trúc cho mạng Kohonen. Tập dữ liệu gồm hai loại đặc trưng là tọa độ x, y nên lớp nhập sẽ gồm 2 nút nhập. Ta cần phân tập dữ liệu thành 2 nhóm nên lớp ra cần có 2 nút. Như vậy ma trận trọng số giữa lớp nhập và lớp xuất là một ma trận 2×2.<br>Giả sử ta khởi tạo bộ trọng số nối với đầu ra 1 là $w_{11} = 2$ và $w_{12} = 3$, bộ trọng số nối với đầu ra 2 là $w_{21} = 4$ và $w_{22} = 2$. Duyệt qua mẫu đầu tiên (1,1), ta có khoảng cách Euclide giữa mẫu dử liệu và từng cặp trọng số lần luợt là d1=\sqrt{(1-2)^2 + (1-3)^2}=2.23d1=<br>(1−2)<br>2<br> +(1−3)<br>2</p>
<p>​     =2.23 và d2=\sqrt{(1-4)^2 + (1-2)^2}=3.16d2=<br>(1−4)<br>2<br> +(1−2)<br>2</p>
<p>​     =3.16. Như vậy ta cập nhật lại bộ trọng số gắn với nút 1 w_{11} = 2 + 0.5<em>(1-2) = 1.5w<br>11<br>​     =2+0.5∗(1−2)=1.5 và w_{12} = 3 + 0.5</em>(1-3) = 2w<br>12<br>​     =3+0.5∗(1−3)=2. Nếu thể hiện bộ trọng số này như một điểm trên đồ thị thì ta có thể thấy rằng điểm này đã đuợc cập nhật để di chuyển dần về phía nhóm dữ liệu 1. Duyệt tiếp điểm số 2 (2,2), ta lại tiếp tục tính d1 = 0.5 và d2 = 2 và tiếp tục cập nhật cho bộ trọng số gần nó hơn: w_{11} = 1.5 + 0.5<em>(2-1.5) = 1.75w<br>11<br>​     =1.5+0.5∗(2−1.5)=1.75 và w_{12} = 2 + 0.5</em>(2-2) = 2w<br>12<br>​     =2+0.5∗(2−2)=2. Duyệt điểm tiếp theo (4,4), ta tính d1 = 3.01, d2 = 2 và cập nhật trọng số gắn với nút 2 w_{21} = 4 + 0.5<em>(4-4) = 4w<br>21<br>​     =4+0.5∗(4−4)=4 và w_{22} = 2 + 0.5</em>(4-2) = 3w<br>22<br>​     =2+0.5∗(4−2)=3. Một lần nữa, ta dễ dàng nhận thấy rằng bộ trọng số 2 đã đuợc kéo về gần với nhóm dữ liệu 2 hơn. Tiếp tục duyệt qua các mẫu dữ liệu còn lại, bộ trọng số sẽ liên tục đuợc cập nhật và đuợc đưa về vị trí trung bình của các nhóm dữ liệu sau một số lượng lần lặp đủ lớn. Như vậy mạng Kohonen đã gom nhóm thành công.</p>
<h2 id="Mo-rong-khong-gian"><a href="#Mo-rong-khong-gian" class="headerlink" title="Mở rộng không gian"></a>Mở rộng không gian</h2><p>Mạng Kohonen hai chiều<br>Đôi khi dữ liệu đầu vào là những đặc trưng sắp xếp theo không gian 2 chiều hoặc các nút lớp ra có thể được sắp xếp theo không gian hai chiều.</p>
<h3 id="kien-truc-2-chieu-cua-mang-kohonen"><a href="#kien-truc-2-chieu-cua-mang-kohonen" class="headerlink" title="kiến trúc 2 chiều của mạng kohonen"></a>kiến trúc 2 chiều của mạng kohonen</h3><p>Trong những kiến trúc mạng lớn, việc cập nhật trong số không chỉ xảy ra ở nơ-ron tốt nhất (best matching unit) mà các nơ-ron trong vùng lân cận cũng có thể được cập nhật. Vùng lân cận ở đây có thể tùy theo bài toán mà có thể là vùng 4 nơ-ron hoặc 8 nơ-ron xung quanh (trong kiến trúc hình chữ nhật) hoặc 6 nơ-ron xung quanh (trong kiến trúc hình lục giác). Việc cập nhật như vậy sẽ khiến những nơ-ron gần nhau sẽ biểu diễn những nhóm có độ tương đồng cao.</p>
<h3 id="Khong-gian-dac-trung"><a href="#Khong-gian-dac-trung" class="headerlink" title="Không gian đặc trưng"></a>Không gian đặc trưng</h3><p>Đôi khi đặc trưng ta rút trích ra có sự phân bố hỗn loạn, những đối tượng đáng lý ra phải thuộc một nhóm thì lại nằm rải rác trong không gian dữ liệu. Do đó, chúng cần chọn một độ đo tương quan cho phù hợp để các đối tượng trong cùng một nhóm phải có khoảng cách gần nhau. Hoặc ta có thể dùng các kernel hay các phương pháp ánh xạ và biến đổi không gian như PCA, LDA để ánh xạ không gian dữ liệu hỗn loạn thành không gian dữ liệu dễ phân tách và gom nhóm hơn.</p>
<h3 id="Gia-tang-dau-ra"><a href="#Gia-tang-dau-ra" class="headerlink" title="Gia tăng đầu ra"></a>Gia tăng đầu ra</h3><p>Xét trong trường hợp mô hình nhận vào một mẩu dữ liệu không thuộc về một bất kỷ lớp nào trong các lớp cho trước. Tuy nhiên dù vậy mô hình vẫn sẽ xếp nó vào nhóm nào có khoảng cách, hay độ tương đồng gần với nó nhất. Một trong những cách xử lý vấn đề này chính là đặt ngưỡng cho giá trị khoảng cách nhỏ nhất. Nếu một mẫu có độ tương đồng tốt nhất với một nhóm nào đó nhưng độ tương đồng này vẫn còn cao hơn ngưỡng, hay khoảng cách từ nó đến tất cả các nhóm đều không đủ nhỏ thì ta có lý do để tin rằng nó là một nhóm mới. Khi phát hiện một nhóm mới ta sẽ hình thành một nút mới tại đầu ra đại diện cho nơ-ron đó với giá trị trọng số chính là giá trị đặc trưng của mẫu vừa tìm được. Với cách này, mô hình có thể dễ dàng mở rộng hơn cho nhiều lớp đối tượng khác nhau.</p>
<h3 id="Khoi-tao-trong-so"><a href="#Khoi-tao-trong-so" class="headerlink" title="Khởi tạo trọng số"></a>Khởi tạo trọng số</h3><p>Khởi tạo trọng số là vấn đề khá quan trọng trong mô hình kohonen. Nếu các giá trị trọng số ban đầu quá xa so với giá trị hội tụ của chúng thì mạng sẽ phải huấn luyện với chi phí thời gian cao. Đối với các bộ dữ liệu có đặc tính phân bố khá tập trung (xác xuất một mẫu dữ liệu có giá trị gần giá trị trung vị cao) thì ta có thể chọn một mẫu dữ liệu và lấy giá trị đặc trưng của nó làm giá trị trọng số cho nút đầu ra.</p>
<p>Bài viết tham khảo từ các nguồn<br>(<a href="https://en.wikipedia.org/wiki/Self-organizing_map" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Self-organizing_map</a>)</p>
</div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"/><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>