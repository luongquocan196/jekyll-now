<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/><meta content="telephone=no" name="format-detection"/><meta name="description"/><title>Mạng Nơ-ron tự tổ chức (Mạng Kohonen) - Self Organising Map | Lương Quốc An</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"/><link rel="stylesheet" type="text/css" href="/css/highlight.css"/><link rel="stylesheet" type="text/css" href="/css/font.css"/><link rel="stylesheet" type="text/css" href="/css/noise.css"/><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"/><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"/></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a></nav><div class="container post-meta"><div class="post-time">2018-05-28</div></div></div><div class="container post-header"><h1>Mạng Nơ-ron tự tổ chức (Mạng Kohonen) - Self Organising Map</h1></div><div class="container post-content"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" integrity="sha384-9tPv11A+glH/on/wEu99NVwDPwkMQESOocs/ZGXPoIiLE8MU/qkqUcZ3zzL+6DuH" crossorigin="anonymous"><a id="more"></a>
<h2 id="t&#x1ED5;ng-quan">T&#x1ED5;ng quan</h2>
<p>M&#x1EA1;ng N&#x1A1;-ron t&#x1EF1; t&#x1ED5; ch&#x1EE9;c (seft-organizing map), hay c&#xF2;n g&#x1ECD;i l&#xE0; m&#x1EA1;ng Kohonen l&#xE0; m&#x1ED9;t lo&#x1EA1;i m&#x1EA1;ng n&#x1A1;-ron nh&#xE2;n t&#x1EA1;o &#x111;&#x1B0;&#x1EE3;c hu&#x1EA5;n luy&#x1EC7;n th&#xF4;ng qua ph&#x1B0;&#x1A1;ng ph&#xE1;p h&#x1ECD;c kh&#xF4;ng gi&#xE1;m s&#xE1;t. Kh&#xE1;c v&#x1EDB;i c&#xE1;c m&#xF4; h&#xEC;nh m&#x1EA1;ng n&#x1A1;-ron truy&#x1EC1;n th&#x1EB3;ng hay m&#x1EA1;ng n&#x1A1;-ron t&#xED;ch ch&#x1EAD;p, m&#x1EA1;ng kohonen s&#x1EED; d&#x1EE5;ng c&#xE1;ch h&#x1ECD;c c&#x1EA1;nh tranh (competitive learing) thay v&#xEC; ph&#x1B0;&#x1A1;ng ph&#xE1;p s&#x1EED;a l&#x1ED7;i (error correction). M&#xF4; h&#xEC;nh n&#xE0;y &#x111;&#x1B0;&#x1EE3;c &#x111;&#x1EC1; xu&#x1EA5;t b&#x1EDF;i Teuvo Kohonen v&#xE0;o nh&#x1EEF;ng n&#x103;m 1980 d&#x1EF1;a tr&#xEA;n m&#x1ED9;t ph&#x1EA7;n c&#xE1;ch th&#x1EE9;c m&#xE0; c&#xE1;c t&#xED;n hi&#x1EC7;u &#x111;&#x1B0;&#x1EE3;c x&#x1EED; l&#xFD; trong n&#xE3;o b&#x1ED9;. C&#x169;ng gi&#x1ED1;ng v&#x1EDB;i c&#xE1;c m&#xF4; h&#xEC;nh n&#x1A1;-ron kh&#xE1;c, m&#x1EA1;ng Kohonen c&#x169;ng c&#x1EA7;n tr&#x1EA3;i qua qu&#xE1; tr&#xEC;nh hu&#x1EA5;n luy&#x1EC7;n. Tuy nhi&#xEA;n, nh&#x1B0; &#x111;&#xE3; &#x111;&#x1EC1; c&#x1EAD;p, ph&#x1B0;&#x1A1;ng ph&#xE1;p v&#xE0; &#xFD; t&#x1B0;&#x1EDF;ng c&#x1EE7;a m&#x1EA1;ng Kohonen c&#xF3; nhi&#x1EC1;u s&#x1EF1; kh&#xE1;c bi&#x1EC7;t so v&#x1EDB;i c&#xE1;c m&#xF4; h&#xEC;nh m&#x1EA1;ng n&#x1A1;-ron h&#x1ECD;c theo ph&#x1B0;&#x1A1;ng ph&#xE1;p h&#x1ECD;c c&#xF3; gi&#xE1;m s&#xE1;t. M&#x1EA1;ng Kohonen v&#x1EDB;i ph&#x1B0;&#x1A1;ng ph&#xE1;p h&#x1ECD;c kh&#xF4;ng gi&#xE1;m s&#xE1;t &#x111;&#x1B0;&#x1EE3;c s&#x1EED; d&#x1EE5;ng hi&#x1EC7;u qu&#x1EA3; trong c&#xE1;c b&#xE0;i to&#xE1;n gom nh&#xF3;m (clustering). C&#xF3; th&#x1EC3; n&#xF3;i m&#xF4; h&#xEC;nh n&#xE0;y g&#x1EA7;n gi&#x1ED1;ng v&#x1EDB;i ph&#x1B0;&#x1A1;ng ph&#xE1;p gom nh&#xF3;m K-mean h&#x1A1;n l&#xE0; c&#xE1;c m&#x1EA1;ng n&#x1A1;-ron kh&#xE1;c.</p>
<h2 id="hu&#x1EA5;n-luy&#x1EC7;n-cho-m&#x1EA1;ng-kohonen">Hu&#x1EA5;n luy&#x1EC7;n cho m&#x1EA1;ng Kohonen</h2>
<p>Ki&#x1EBF;n tr&#xFA;c c&#x1EE7;a m&#x1ED9;t m&#x1EA1;ng Kohonen &#x111;&#x1A1;n gi&#x1EA3;n bao g&#x1ED3;m 2 l&#x1EDB;p: l&#x1EDB;p nh&#x1EAD;p v&#xE0; l&#x1EDB;p xu&#x1EA5;t. L&#x1EDB;p nh&#x1EAD;p bao g&#x1ED3;m c&#xE1;c n&#xFA;t &#x1EE9;ng v&#x1EDB;i c&#xE1;c &#x111;&#x1EB7;c tr&#x1B0;ng c&#x1EE7;a d&#x1EEF; li&#x1EC7;u &#x111;&#x1EA7;u v&#xE0;o. N&#x1EBF;u d&#x1EEF; li&#x1EC7;u &#x111;&#x1EA7;u v&#xE0;o l&#xE0; m&#x1ED9;t vector c&#xF3; m &#x111;&#x1EB7;c tr&#x1B0;ng th&#xEC; l&#x1EDB;p nh&#x1EAD;p s&#x1EBD; c&#xF3; m n&#xFA;t t&#x1B0;&#x1A1;ng &#x1EE9;ng. L&#x1EDB;p xu&#x1EA5;t &#x111;&#x1EA1;i di&#x1EC7;n cho s&#x1ED1; l&#x1B0;&#x1EE3;ng nh&#xF3;m c&#x1EA7;n gom nh&#xF3;m. N&#x1EBF;u b&#xE0;i to&#xE1;n y&#xEA;u c&#x1EA7;u ph&#xE2;n lo&#x1EA1;i c&#xE1;c &#x111;&#x1ED1;i t&#x1B0;&#x1EE3;ng th&#xE0;nh 10 nh&#xF3;m th&#xEC; l&#x1EDB;p xu&#x1EA5;t s&#x1EBD; g&#x1ED3;m 10 n&#xFA;t.</p>
<p align="center">
<img src="/images/Kohonen-net.png" align="center" width="500">
</p>
<p>C&#xE1;c n&#xFA;t &#x1EDF; l&#x1EDB;p nh&#x1EAD;p v&#xE0; l&#x1EDB;p xu&#x1EA5;t &#x111;&#x1B0;&#x1EE3;c li&#xEA;n k&#x1EBF;t &#x111;&#x1EA7;y &#x111;&#x1EE7; v&#x1EDB;i nhau th&#xF4;ng qua c&#xE1;c tr&#x1ECD;ng s&#x1ED1; w. Nh&#x1B0; v&#x1EAD;y m&#x1ED9;t n&#x1A1;-ron &#x1EDF; &#x111;&#x1EA7;u ra s&#x1EBD; c&#xF3; m tr&#x1ECD;ng s&#x1ED1; n&#x1ED1;i &#x111;&#x1EBF;n n&#xF3; t&#x1B0;&#x1A1;ng &#x1EE9;ng v&#x1EDB;i m &#x111;&#x1EB7;c tr&#x1B0;ng c&#x1EE7;a d&#x1EEF; li&#x1EC7;u &#x111;&#x1EA7;u v&#xE0;o. C&#xE1;c tr&#x1ECD;ng s&#x1ED1; n&#xE0;y &#x111;&#xF3;ng vai tr&#xF2; &#x111;&#x1EA1;i di&#x1EC7;n cho nh&#xF3;m t&#x1B0;&#x1A1;ng &#x1EE9;ng v&#x1EDB;i n&#x1A1;-ron &#x1EDF; l&#x1EDB;p xu&#x1EA5;t v&#xE0; c&#xF3; nhi&#x1EC7;m v&#x1EE5; t&#xED;nh to&#xE1;n v&#xE0; ph&#xE2;n lo&#x1EA1;i &#x111;&#x1ED1;i t&#x1B0;&#x1EE3;ng &#x111;&#x1EA7;u v&#xE0;o s&#x1EBD; v&#xE0;o l&#x1EDB;p n&#xE0;o trong c&#xE1;c n&#xFA;t &#x1EDF; &#x111;&#x1EA7;u ra. C&#xE1;c gi&#xE1; tr&#x1ECB; tr&#x1ECD;ng s&#x1ED1; w s&#x1EBD; &#x111;&#x1B0;&#x1EE3;c kh&#x1EDF;i g&#xE1;n ng&#x1EAB;u nhi&#xEA;n khi kh&#x1EDF;i t&#x1EA1;o m&#xF4; h&#xEC;nh.</p>
<h2 id="qu&#xE1;-tr&#xEC;nh-hu&#x1EA5;n-luy&#x1EC7;n">Qu&#xE1; tr&#xEC;nh hu&#x1EA5;n luy&#x1EC7;n</h2>
<p>V&#x1EDB;i m&#x1ED9;t m&#x1EA1;ng Kohonen c&#xF3; m &#x111;&#x1EB7;c tr&#x1B0;ng &#x111;&#x1EA7;u v&#xE0;o c&#x1EA7;n gom nh&#xF3;m th&#xE0;nh n nh&#xF3;m &#x111;&#x1EA7;u ra, ta g&#x1ECD;i wij l&#xE0; tr&#x1ECD;ng s&#x1ED1; n&#x1ED1;i gi&#x1EEF;a &#x111;&#x1EA7;u v&#xE0;o th&#x1EE9; j v&#xE0; &#x111;&#x1EA7;u ra th&#x1EE9; i. M&#x1ED9;t m&#x1EAB;u d&#x1EEF; li&#x1EC7;u v&#xE0;o s&#x1EBD; g&#x1ED3;m m &#x111;&#x1EB7;c tr&#x1B0;ng xj (j t&#x1EEB; 1 &#x111;&#x1EBF;n m). Qu&#xE1; tr&#xEC;nh hu&#x1EA5;n luy&#x1EC7;n cho m&#x1EA1;ng kohonen nh&#x1B0; sau:</p>
<ul>
<li>L&#x1EA5;y m&#x1ED9;t m&#x1EAB;u d&#x1EEF; li&#x1EC7;u h&#x1ECD;c &#x111;&#x1B0;a v&#xE0;o m&#xF4; h&#xEC;nh.</li>
<li>V&#x1EDB;i m&#x1ED7;i n&#xFA;t t&#x1EA1;i l&#x1EDB;p ra, t&#xED;nh kho&#x1EA3;ng c&#xE1;ch Euclide (ho&#x1EB7;c m&#x1ED9;t &#x111;&#x1ED9; &#x111;o th&#xED;ch h&#x1EE3;p kh&#xE1;c) gi&#x1EEF;a vector &#x111;&#x1EB7;c tr&#x1B0;ng &#x111;&#x1EA7;u v&#xE0;o v&#xE0; vector tr&#x1ECD;ng s&#x1ED1; n&#x1ED1;i v&#x1EDB;i nut &#x111;&#xF3;. L&#x1EA5;y n&#xFA;t c&#xF3; gi&#xE1; tr&#x1ECB; t&#xED;nh &#x111;&#x1B0;&#x1EE3;c nh&#x1ECF; nh&#x1EA5;t, g&#x1ECD;i l&#xE0; best matching unit.</li>
<li>C&#x1EAD;p nh&#x1EAD;t tr&#x1ECD;ng s&#x1ED1; g&#x1EAF;n v&#x1EDB;i n&#xFA;t &#x111;&#xF3;: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub><mo>=</mo><mi>W</mi><mo>+</mo><mi>&#x3B1;</mi><mo>&#x2217;</mo><mo>(</mo><mi>X</mi><mo>&#x2212;</mo><mi>W</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">W_{new} = W + \alpha * (X - W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span>. V&#x1EDB;i <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B1;</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span></span></span></span> l&#xE0; h&#x1EC7; s&#x1ED1; h&#x1ECD;c, th&#x1EC3; hi&#x1EC7;n cho m&#x1EE9;c &#x111;&#x1ED9; c&#x1EAD;p nh&#x1EAD;t W sau m&#x1ED7;i l&#x1EA7;n l&#x1EB7;p.</li>
<li>Ti&#x1EBF;n h&#xE0;nh l&#x1EB7;p l&#x1EA1;i c&#xE1;c b&#x1B0;&#x1EDB;c tr&#xEA;n cho m&#x1EAB;u d&#x1EEF; li&#x1EC7;u m&#x1EDB;i cho &#x111;&#x1EBF;n khi &#x111;&#x1EA1;t m&#x1ED9;t s&#x1ED1; l&#x1EA7;n l&#x1EB7;p nh&#x1EA5;t &#x111;&#x1ECB;nh. Ta th&#x1EA5;y r&#x1EB1;ng c&#xE1;ch th&#x1EE9;c ho&#x1EA1;t &#x111;&#x1ED9;ng c&#x1EE7;a m&#xF4; h&#xEC;nh r&#x1EA5;t gi&#x1ED1;ng v&#x1EDB;i thu&#x1EAD;t to&#xE1;n k-mean. C&#x1EE9; m&#x1ED7;i m&#x1EAB;u d&#x1EEF; li&#x1EC7;u &#x111;&#x1B0;a v&#xE0;o th&#xEC; gi&#xE1; tr&#x1ECB; tr&#x1ECD;ng s&#x1ED1; c&#x1EE7;a n&#xFA;t g&#x1EA7;n n&#xF3; nh&#x1EA5;t (best matching unit) s&#x1EBD; &#x111;&#x1B0;&#x1EE3;c c&#x1EAD;p nh&#x1EAD;t l&#x1EA1;i theo ki&#x1EC3;u k&#xE9;o d&#x1EA7;n v&#x1EC1; ph&#xED;a c&#x1EE7;a m&#x1EAB;u d&#x1EEF; li&#x1EC7;u trong kh&#xF4;ng gian bi&#x1EC3;u di&#x1EC5;n. Nh&#x1B0; v&#x1EAD;y sau nhi&#x1EC1;u m&#x1EAB;u d&#x1EEF; li&#x1EC7;u &#x111;&#x1B0;&#x1EE3;c d&#xF9;ng &#x111;&#x1EC3; h&#x1ECD;c th&#xEC; gi&#xE1; tr&#x1ECB; tr&#x1ECD;ng s&#x1ED1; c&#x1EE7;a m&#x1ED9;t n&#xFA;t &#x111;&#x1EA7;u ra ch&#xED;nh l&#xE0; &#x111;&#x1EB7;c tr&#x1B0;ng trung b&#xEC;nh c&#x1EE7;a n&#xFA;t &#x111;&#xF3;. N&#x1EBF;u m&#x1ED9;t m&#x1EAB;u d&#x1EEF; li&#x1EC1;u m&#x1EDB;i c&#x1EA7;n ph&#xE2;n lo&#x1EA1;i &#x111;&#x1B0;&#x1EE3;c &#x111;&#x1B0;a v&#xE0;o, kho&#x1EA3;ng c&#xE1;ch t&#x1EEB; n&#xF3; &#x111;&#x1EBF;n gi&#xE1; tr&#x1ECB; trung b&#xEC;nh n&#xE0;o nh&#x1ECF; nh&#x1EA5;t th&#xEC; n&#xF3; s&#x1EBD; c&#xF3; nhi&#x1EC1;u kh&#x1EA3; n&#x103;ng thu&#x1ED9;c nh&#xF3;m &#x111;&#xF3;.</li>
</ul>
<h2 id="v&#xED;-d&#x1EE5;">V&#xED; d&#x1EE5;</h2>
<p>X&#xE9;t m&#x1ED9;t t&#x1EAD;p d&#x1EEF; li&#x1EC7;u g&#x1ED3;m 8 m&#x1EAB;u (1,1), (1,2), (2,1), (2,2), (4,4), (4,5), (5,4), (5,5) nh&#x1B0; sau:</p>
<p align="center">
<img src="/images/exampleKohonen.png" align="center" width="500">
</p>
<p>Y&#xEA;u c&#x1EA7;u &#x111;&#x1EB7;t ra l&#xE0; s&#x1EED; d&#x1EE5;ng m&#x1EA1;ng Kohonen &#x111;&#x1EC3; ph&#xE2;n t&#x1EAD;p d&#x1EEF; li&#x1EC7;u n&#xE0;y th&#xE0;nh 2 nh&#xF3;m. Tru&#x1EDB;c ti&#xEA;n ta c&#x1EA7;n x&#xE2;y d&#x1EF1;ng ki&#x1EBF;n tr&#xFA;c cho m&#x1EA1;ng Kohonen. T&#x1EAD;p d&#x1EEF; li&#x1EC7;u g&#x1ED3;m hai lo&#x1EA1;i &#x111;&#x1EB7;c tr&#x1B0;ng l&#xE0; t&#x1ECD;a &#x111;&#x1ED9; x, y n&#xEA;n l&#x1EDB;p nh&#x1EAD;p s&#x1EBD; g&#x1ED3;m 2 n&#xFA;t nh&#x1EAD;p. Ta c&#x1EA7;n ph&#xE2;n t&#x1EAD;p d&#x1EEF; li&#x1EC7;u th&#xE0;nh 2 nh&#xF3;m n&#xEA;n l&#x1EDB;p ra c&#x1EA7;n c&#xF3; 2 n&#xFA;t. Nh&#x1B0; v&#x1EAD;y ma tr&#x1EAD;n tr&#x1ECD;ng s&#x1ED1; gi&#x1EEF;a l&#x1EDB;p nh&#x1EAD;p v&#xE0; l&#x1EDB;p xu&#x1EA5;t l&#xE0; m&#x1ED9;t ma tr&#x1EAD;n 2&#xD7;2. Gi&#x1EA3; s&#x1EED; ta kh&#x1EDF;i t&#x1EA1;o b&#x1ED9; tr&#x1ECD;ng s&#x1ED1; n&#x1ED1;i v&#x1EDB;i &#x111;&#x1EA7;u ra 1 l&#xE0; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>11</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">w_{11} = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> v&#xE0; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>12</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">w_{12} = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>, b&#x1ED9; tr&#x1ECD;ng s&#x1ED1; n&#x1ED1;i v&#x1EDB;i &#x111;&#x1EA7;u ra 2 l&#xE0; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>21</mn></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">w_{21} = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span> v&#xE0; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>22</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">w_{22} = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>. Duy&#x1EC7;t qua m&#x1EAB;u &#x111;&#x1EA7;u ti&#xEA;n (1,1), ta c&#xF3; kho&#x1EA3;ng c&#xE1;ch Euclide gi&#x1EEF;a m&#x1EAB;u d&#x1EED; li&#x1EC7;u v&#xE0; t&#x1EEB;ng c&#x1EB7;p tr&#x1ECD;ng s&#x1ED1; l&#x1EA7;n lu&#x1EE3;t l&#xE0; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mn>1</mn><mo>=</mo><msqrt><mrow><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><mn>2</mn><msup><mo>)</mo><mn>2</mn></msup><mo>+</mo><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><mn>3</mn><msup><mo>)</mo><mn>2</mn></msup></mrow></msqrt><mo>=</mo><mn>2.23</mn></mrow><annotation encoding="application/x-tex">d1=\sqrt{(1-2)^2 + (1-3)^2}=2.23</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">d</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.30499999999999994em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.935em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.8950000000000005em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width="400em" height="1.28em" viewbox="0 0 400000 1296" preserveaspectratio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,
158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067
c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,
175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71
c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,
-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26
s76,-59,76,-59s76,-60,76,-60z M1001 80H40000v40H1012z"/></svg></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.30499999999999994em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">2</span><span class="mord">3</span></span></span></span> v&#xE0; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mn>2</mn><mo>=</mo><msqrt><mrow><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><mn>4</mn><msup><mo>)</mo><mn>2</mn></msup><mo>+</mo><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><mn>2</mn><msup><mo>)</mo><mn>2</mn></msup></mrow></msqrt><mo>=</mo><mn>3.16</mn></mrow><annotation encoding="application/x-tex">d2=\sqrt{(1-4)^2 + (1-2)^2}=3.16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">d</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.30499999999999994em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.935em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.8950000000000005em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width="400em" height="1.28em" viewbox="0 0 400000 1296" preserveaspectratio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,
158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067
c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,
175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71
c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,
-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26
s76,-59,76,-59s76,-60,76,-60z M1001 80H40000v40H1012z"/></svg></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.30499999999999994em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">.</span><span class="mord">1</span><span class="mord">6</span></span></span></span>. Nh&#x1B0; v&#x1EAD;y ta c&#x1EAD;p nh&#x1EAD;t l&#x1EA1;i b&#x1ED9; tr&#x1ECD;ng s&#x1ED1; g&#x1EAF;n v&#x1EDB;i n&#xFA;t 1 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>11</mn></msub><mo>=</mo><mn>2</mn><mo>+</mo><mn>0.5</mn><mo>&#x2217;</mo><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><mn>2</mn><mo>)</mo><mo>=</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">w_{11} = 2 + 0.5*(1-2) = 1.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span></span></span></span> v&#xE0; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>12</mn></msub><mo>=</mo><mn>3</mn><mo>+</mo><mn>0.5</mn><mo>&#x2217;</mo><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><mn>3</mn><mo>)</mo><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">w_{12} = 3 + 0.5*(1-3) = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>. N&#x1EBF;u th&#x1EC3; hi&#x1EC7;n b&#x1ED9; tr&#x1ECD;ng s&#x1ED1; n&#xE0;y nh&#x1B0; m&#x1ED9;t &#x111;i&#x1EC3;m tr&#xEA;n &#x111;&#x1ED3; th&#x1ECB; th&#xEC; ta c&#xF3; th&#x1EC3; th&#x1EA5;y r&#x1EB1;ng &#x111;i&#x1EC3;m n&#xE0;y &#x111;&#xE3; &#x111;u&#x1EE3;c c&#x1EAD;p nh&#x1EAD;t &#x111;&#x1EC3; di chuy&#x1EC3;n d&#x1EA7;n v&#x1EC1; ph&#xED;a nh&#xF3;m d&#x1EEF; li&#x1EC7;u 1. Duy&#x1EC7;t ti&#x1EBF;p &#x111;i&#x1EC3;m s&#x1ED1; 2 (2,2), ta l&#x1EA1;i ti&#x1EBF;p t&#x1EE5;c t&#xED;nh d1 = 0.5 v&#xE0; d2 = 2 v&#xE0; ti&#x1EBF;p t&#x1EE5;c c&#x1EAD;p nh&#x1EAD;t cho b&#x1ED9; tr&#x1ECD;ng s&#x1ED1; g&#x1EA7;n n&#xF3; h&#x1A1;n: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>11</mn></msub><mo>=</mo><mn>1.5</mn><mo>+</mo><mn>0.5</mn><mo>&#x2217;</mo><mo>(</mo><mn>2</mn><mo>&#x2212;</mo><mn>1.5</mn><mo>)</mo><mo>=</mo><mn>1.75</mn></mrow><annotation encoding="application/x-tex">w_{11} = 1.5 + 0.5*(2-1.5) = 1.75</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">7</span><span class="mord">5</span></span></span></span> v&#xE0; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>12</mn></msub><mo>=</mo><mn>2</mn><mo>+</mo><mn>0.5</mn><mo>&#x2217;</mo><mo>(</mo><mn>2</mn><mo>&#x2212;</mo><mn>2</mn><mo>)</mo><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">w_{12} = 2 + 0.5*(2-2) = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>. Duy&#x1EC7;t &#x111;i&#x1EC3;m ti&#x1EBF;p theo (4,4), ta t&#xED;nh d1 = 3.01, d2 = 2 v&#xE0; c&#x1EAD;p nh&#x1EAD;t tr&#x1ECD;ng s&#x1ED1; g&#x1EAF;n v&#x1EDB;i n&#xFA;t 2 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>21</mn></msub><mo>=</mo><mn>4</mn><mo>+</mo><mn>0.5</mn><mo>&#x2217;</mo><mo>(</mo><mn>4</mn><mo>&#x2212;</mo><mn>4</mn><mo>)</mo><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">w_{21} = 4 + 0.5*(4-4) = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span> v&#xE0; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>22</mn></msub><mo>=</mo><mn>2</mn><mo>+</mo><mn>0.5</mn><mo>&#x2217;</mo><mo>(</mo><mn>4</mn><mo>&#x2212;</mo><mn>2</mn><mo>)</mo><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">w_{22} = 2 + 0.5*(4-2) = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>. M&#x1ED9;t l&#x1EA7;n n&#x1EEF;a, ta d&#x1EC5; d&#xE0;ng nh&#x1EAD;n th&#x1EA5;y r&#x1EB1;ng b&#x1ED9; tr&#x1ECD;ng s&#x1ED1; 2 &#x111;&#xE3; &#x111;u&#x1EE3;c k&#xE9;o v&#x1EC1; g&#x1EA7;n v&#x1EDB;i nh&#xF3;m d&#x1EEF; li&#x1EC7;u 2 h&#x1A1;n. Ti&#x1EBF;p t&#x1EE5;c duy&#x1EC7;t qua c&#xE1;c m&#x1EAB;u d&#x1EEF; li&#x1EC7;u c&#xF2;n l&#x1EA1;i, b&#x1ED9; tr&#x1ECD;ng s&#x1ED1; s&#x1EBD; li&#xEA;n t&#x1EE5;c &#x111;u&#x1EE3;c c&#x1EAD;p nh&#x1EAD;t v&#xE0; &#x111;u&#x1EE3;c &#x111;&#x1B0;a v&#x1EC1; v&#x1ECB; tr&#xED; trung b&#xEC;nh c&#x1EE7;a c&#xE1;c nh&#xF3;m d&#x1EEF; li&#x1EC7;u sau m&#x1ED9;t s&#x1ED1; l&#x1B0;&#x1EE3;ng l&#x1EA7;n l&#x1EB7;p &#x111;&#x1EE7; l&#x1EDB;n. Nh&#x1B0; v&#x1EAD;y m&#x1EA1;ng Kohonen &#x111;&#xE3; gom nh&#xF3;m th&#xE0;nh c&#xF4;ng.</p>
<h2 id="m&#x1EDF;-r&#x1ED9;ng-kh&#xF4;ng-gian">M&#x1EDF; r&#x1ED9;ng kh&#xF4;ng gian</h2>
<p>M&#x1EA1;ng Kohonen hai chi&#x1EC1;u &#x110;&#xF4;i khi d&#x1EEF; li&#x1EC7;u &#x111;&#x1EA7;u v&#xE0;o l&#xE0; nh&#x1EEF;ng &#x111;&#x1EB7;c tr&#x1B0;ng s&#x1EAF;p x&#x1EBF;p theo kh&#xF4;ng gian 2 chi&#x1EC1;u ho&#x1EB7;c c&#xE1;c n&#xFA;t l&#x1EDB;p ra c&#xF3; th&#x1EC3; &#x111;&#x1B0;&#x1EE3;c s&#x1EAF;p x&#x1EBF;p theo kh&#xF4;ng gian hai chi&#x1EC1;u.</p>
<h3 id="ki&#x1EBF;n-tr&#xFA;c-2-chi&#x1EC1;u-c&#x1EE7;a-m&#x1EA1;ng-kohonen">ki&#x1EBF;n tr&#xFA;c 2 chi&#x1EC1;u c&#x1EE7;a m&#x1EA1;ng kohonen</h3>
<p>Trong nh&#x1EEF;ng ki&#x1EBF;n tr&#xFA;c m&#x1EA1;ng l&#x1EDB;n, vi&#x1EC7;c c&#x1EAD;p nh&#x1EAD;t trong s&#x1ED1; kh&#xF4;ng ch&#x1EC9; x&#x1EA3;y ra &#x1EDF; n&#x1A1;-ron t&#x1ED1;t nh&#x1EA5;t (best matching unit) m&#xE0; c&#xE1;c n&#x1A1;-ron trong v&#xF9;ng l&#xE2;n c&#x1EAD;n c&#x169;ng c&#xF3; th&#x1EC3; &#x111;&#x1B0;&#x1EE3;c c&#x1EAD;p nh&#x1EAD;t. V&#xF9;ng l&#xE2;n c&#x1EAD;n &#x1EDF; &#x111;&#xE2;y c&#xF3; th&#x1EC3; t&#xF9;y theo b&#xE0;i to&#xE1;n m&#xE0; c&#xF3; th&#x1EC3; l&#xE0; v&#xF9;ng 4 n&#x1A1;-ron ho&#x1EB7;c 8 n&#x1A1;-ron xung quanh (trong ki&#x1EBF;n tr&#xFA;c h&#xEC;nh ch&#x1EEF; nh&#x1EAD;t) ho&#x1EB7;c 6 n&#x1A1;-ron xung quanh (trong ki&#x1EBF;n tr&#xFA;c h&#xEC;nh l&#x1EE5;c gi&#xE1;c). Vi&#x1EC7;c c&#x1EAD;p nh&#x1EAD;t nh&#x1B0; v&#x1EAD;y s&#x1EBD; khi&#x1EBF;n nh&#x1EEF;ng n&#x1A1;-ron g&#x1EA7;n nhau s&#x1EBD; bi&#x1EC3;u di&#x1EC5;n nh&#x1EEF;ng nh&#xF3;m c&#xF3; &#x111;&#x1ED9; t&#x1B0;&#x1A1;ng &#x111;&#x1ED3;ng cao.</p>
<h3 id="kh&#xF4;ng-gian-&#x111;&#x1EB7;c-tr&#x1B0;ng">Kh&#xF4;ng gian &#x111;&#x1EB7;c tr&#x1B0;ng</h3>
<p>&#x110;&#xF4;i khi &#x111;&#x1EB7;c tr&#x1B0;ng ta r&#xFA;t tr&#xED;ch ra c&#xF3; s&#x1EF1; ph&#xE2;n b&#x1ED1; h&#x1ED7;n lo&#x1EA1;n, nh&#x1EEF;ng &#x111;&#x1ED1;i t&#x1B0;&#x1EE3;ng &#x111;&#xE1;ng l&#xFD; ra ph&#x1EA3;i thu&#x1ED9;c m&#x1ED9;t nh&#xF3;m th&#xEC; l&#x1EA1;i n&#x1EB1;m r&#x1EA3;i r&#xE1;c trong kh&#xF4;ng gian d&#x1EEF; li&#x1EC7;u. Do &#x111;&#xF3;, ch&#xFA;ng c&#x1EA7;n ch&#x1ECD;n m&#x1ED9;t &#x111;&#x1ED9; &#x111;o t&#x1B0;&#x1A1;ng quan cho ph&#xF9; h&#x1EE3;p &#x111;&#x1EC3; c&#xE1;c &#x111;&#x1ED1;i t&#x1B0;&#x1EE3;ng trong c&#xF9;ng m&#x1ED9;t nh&#xF3;m ph&#x1EA3;i c&#xF3; kho&#x1EA3;ng c&#xE1;ch g&#x1EA7;n nhau. Ho&#x1EB7;c ta c&#xF3; th&#x1EC3; d&#xF9;ng c&#xE1;c kernel hay c&#xE1;c ph&#x1B0;&#x1A1;ng ph&#xE1;p &#xE1;nh x&#x1EA1; v&#xE0; bi&#x1EBF;n &#x111;&#x1ED5;i kh&#xF4;ng gian nh&#x1B0; PCA, LDA &#x111;&#x1EC3; &#xE1;nh x&#x1EA1; kh&#xF4;ng gian d&#x1EEF; li&#x1EC7;u h&#x1ED7;n lo&#x1EA1;n th&#xE0;nh kh&#xF4;ng gian d&#x1EEF; li&#x1EC7;u d&#x1EC5; ph&#xE2;n t&#xE1;ch v&#xE0; gom nh&#xF3;m h&#x1A1;n.</p>
<h3 id="gia-t&#x103;ng-&#x111;&#x1EA7;u-ra">Gia t&#x103;ng &#x111;&#x1EA7;u ra</h3>
<p>X&#xE9;t trong tr&#x1B0;&#x1EDD;ng h&#x1EE3;p m&#xF4; h&#xEC;nh nh&#x1EAD;n v&#xE0;o m&#x1ED9;t m&#x1EA9;u d&#x1EEF; li&#x1EC7;u kh&#xF4;ng thu&#x1ED9;c v&#x1EC1; m&#x1ED9;t b&#x1EA5;t k&#x1EF7; l&#x1EDB;p n&#xE0;o trong c&#xE1;c l&#x1EDB;p cho tr&#x1B0;&#x1EDB;c. Tuy nhi&#xEA;n d&#xF9; v&#x1EAD;y m&#xF4; h&#xEC;nh v&#x1EAB;n s&#x1EBD; x&#x1EBF;p n&#xF3; v&#xE0;o nh&#xF3;m n&#xE0;o c&#xF3; kho&#x1EA3;ng c&#xE1;ch, hay &#x111;&#x1ED9; t&#x1B0;&#x1A1;ng &#x111;&#x1ED3;ng g&#x1EA7;n v&#x1EDB;i n&#xF3; nh&#x1EA5;t. M&#x1ED9;t trong nh&#x1EEF;ng c&#xE1;ch x&#x1EED; l&#xFD; v&#x1EA5;n &#x111;&#x1EC1; n&#xE0;y ch&#xED;nh l&#xE0; &#x111;&#x1EB7;t ng&#x1B0;&#x1EE1;ng cho gi&#xE1; tr&#x1ECB; kho&#x1EA3;ng c&#xE1;ch nh&#x1ECF; nh&#x1EA5;t. N&#x1EBF;u m&#x1ED9;t m&#x1EAB;u c&#xF3; &#x111;&#x1ED9; t&#x1B0;&#x1A1;ng &#x111;&#x1ED3;ng t&#x1ED1;t nh&#x1EA5;t v&#x1EDB;i m&#x1ED9;t nh&#xF3;m n&#xE0;o &#x111;&#xF3; nh&#x1B0;ng &#x111;&#x1ED9; t&#x1B0;&#x1A1;ng &#x111;&#x1ED3;ng n&#xE0;y v&#x1EAB;n c&#xF2;n cao h&#x1A1;n ng&#x1B0;&#x1EE1;ng, hay kho&#x1EA3;ng c&#xE1;ch t&#x1EEB; n&#xF3; &#x111;&#x1EBF;n t&#x1EA5;t c&#x1EA3; c&#xE1;c nh&#xF3;m &#x111;&#x1EC1;u kh&#xF4;ng &#x111;&#x1EE7; nh&#x1ECF; th&#xEC; ta c&#xF3; l&#xFD; do &#x111;&#x1EC3; tin r&#x1EB1;ng n&#xF3; l&#xE0; m&#x1ED9;t nh&#xF3;m m&#x1EDB;i. Khi ph&#xE1;t hi&#x1EC7;n m&#x1ED9;t nh&#xF3;m m&#x1EDB;i ta s&#x1EBD; h&#xEC;nh th&#xE0;nh m&#x1ED9;t n&#xFA;t m&#x1EDB;i t&#x1EA1;i &#x111;&#x1EA7;u ra &#x111;&#x1EA1;i di&#x1EC7;n cho n&#x1A1;-ron &#x111;&#xF3; v&#x1EDB;i gi&#xE1; tr&#x1ECB; tr&#x1ECD;ng s&#x1ED1; ch&#xED;nh l&#xE0; gi&#xE1; tr&#x1ECB; &#x111;&#x1EB7;c tr&#x1B0;ng c&#x1EE7;a m&#x1EAB;u v&#x1EEB;a t&#xEC;m &#x111;&#x1B0;&#x1EE3;c. V&#x1EDB;i c&#xE1;ch n&#xE0;y, m&#xF4; h&#xEC;nh c&#xF3; th&#x1EC3; d&#x1EC5; d&#xE0;ng m&#x1EDF; r&#x1ED9;ng h&#x1A1;n cho nhi&#x1EC1;u l&#x1EDB;p &#x111;&#x1ED1;i t&#x1B0;&#x1EE3;ng kh&#xE1;c nhau.</p>
<h3 id="kh&#x1EDF;i-t&#x1EA1;o-tr&#x1ECD;ng-s&#x1ED1;">Kh&#x1EDF;i t&#x1EA1;o tr&#x1ECD;ng s&#x1ED1;</h3>
<p>Kh&#x1EDF;i t&#x1EA1;o tr&#x1ECD;ng s&#x1ED1; l&#xE0; v&#x1EA5;n &#x111;&#x1EC1; kh&#xE1; quan tr&#x1ECD;ng trong m&#xF4; h&#xEC;nh kohonen. N&#x1EBF;u c&#xE1;c gi&#xE1; tr&#x1ECB; tr&#x1ECD;ng s&#x1ED1; ban &#x111;&#x1EA7;u qu&#xE1; xa so v&#x1EDB;i gi&#xE1; tr&#x1ECB; h&#x1ED9;i t&#x1EE5; c&#x1EE7;a ch&#xFA;ng th&#xEC; m&#x1EA1;ng s&#x1EBD; ph&#x1EA3;i hu&#x1EA5;n luy&#x1EC7;n v&#x1EDB;i chi ph&#xED; th&#x1EDD;i gian cao. &#x110;&#x1ED1;i v&#x1EDB;i c&#xE1;c b&#x1ED9; d&#x1EEF; li&#x1EC7;u c&#xF3; &#x111;&#x1EB7;c t&#xED;nh ph&#xE2;n b&#x1ED1; kh&#xE1; t&#x1EAD;p trung (x&#xE1;c xu&#x1EA5;t m&#x1ED9;t m&#x1EAB;u d&#x1EEF; li&#x1EC7;u c&#xF3; gi&#xE1; tr&#x1ECB; g&#x1EA7;n gi&#xE1; tr&#x1ECB; trung v&#x1ECB; cao) th&#xEC; ta c&#xF3; th&#x1EC3; ch&#x1ECD;n m&#x1ED9;t m&#x1EAB;u d&#x1EEF; li&#x1EC7;u v&#xE0; l&#x1EA5;y gi&#xE1; tr&#x1ECB; &#x111;&#x1EB7;c tr&#x1B0;ng c&#x1EE7;a n&#xF3; l&#xE0;m gi&#xE1; tr&#x1ECB; tr&#x1ECD;ng s&#x1ED1; cho n&#xFA;t &#x111;&#x1EA7;u ra.</p>
<h2 id="x&#xE2;y-d&#x1EF1;ng-m&#x1EA1;ng-kohonen-tr&#xEA;n-t&#x1EAD;p-mnist">X&#xE2;y d&#x1EF1;ng m&#x1EA1;ng Kohonen tr&#xEA;n t&#x1EAD;p MNIST</h2>
<h3 id="d&#x1EEF;-li&#x1EC7;u-v&#xE0;-si&#xEA;u-tham-s&#x1ED1;">D&#x1EEF; li&#x1EC7;u v&#xE0; si&#xEA;u tham s&#x1ED1;</h3>
Vi&#x1EC7;c &#x111;&#x1EA7;u ti&#xEA;n, ch&#xFA;ng ta c&#x1EA7;n chu&#x1EA9;n b&#x1ECB; d&#x1EEF; li&#x1EC7;u. Ch&#xFA;ng ta c&#xF3; th&#x1EC3; s&#x1EED; d&#x1EE5;ng t&#x1EAD;p d&#x1EEF; li&#x1EC7;u MNIST &#x111;&#x1B0;&#x1EE3;c cung c&#x1EA5;p s&#x1EB5;n trong th&#x1B0; vi&#x1EC7;n tensorflow. M&#x1ED9;t m&#x1EAB;u d&#x1EEF; li&#x1EC7;u trong t&#x1EAD;p MNIST c&#xF3; s&#x1ED1; chi&#x1EC1;u l&#xE0; 784 &#x1EE9;ng v&#x1EDB;i m&#x1ED9;t &#x1EA3;nh 28x28. Ta s&#x1EBD; chuy&#x1EC3;n c&#xE1;c m&#x1EAB;u d&#x1EEF; li&#x1EC7;u n&#xE0;y v&#x1EC1; 1x784 chi&#x1EC1;u &#x111;&#x1EC3; d&#x1EC5; trong vi&#x1EC7;c t&#xED;nh to&#xE1;n.
<pre class="lang:Python decode:true">from tensorflow.examples.tutorials.mnist import input_data
mnist = input_data.read_data_sets(&quot;MNIST_data/&quot;, one_hot=True)
train = mnist.train.images.reshape(data.train.images.shape[0], 1, 784)
</pre>
Ti&#x1EBF;p theo ch&#xFA;ng ta c&#x1EA7;n x&#xE1;c &#x111;&#x1ECB;nh c&#xE1;c si&#xEA;u tham s&#x1ED1; c&#x1EE7;a m&#xF4; h&#xEC;nh. C&#xF3; 2 si&#xEA;u tham s&#x1ED1; quan tr&#x1ECD;ng l&#xE0; h&#x1EC7; s&#x1ED1; h&#x1ECD;c <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B1;</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span></span></span></span> v&#xE0; s&#x1ED1; l&#x1B0;&#x1EE3;ng nodes &#x111;&#x1EA7;u ra c&#x1EE7;a m&#xF4; h&#xEC;nh hay s&#x1ED1; nh&#xF3;m m&#xE0; ch&#xFA;ng ta c&#x1EA7;n gom nh&#xF3;m. &#x110;&#xF4;&#xED; v&#x1EDB;i t&#x1EAD;p MNIST th&#xEC; ta c&#xF3; 10 nh&#xF3;m &#x1EE9;ng v&#x1EDB;i 10 k&#xFD; s&#x1ED1; kh&#xE1;c nhau. Tuy nhi&#xEA;n, s&#x1ED1; l&#x1B0;&#x1EE3;ng v&#xE0; m&#x1EAD;t &#x111;&#x1ED9; ph&#xE2;n b&#x1ED1; c&#x1EE7;a c&#xE1;c m&#x1EAB;u d&#x1EEF; li&#x1EC7;u r&#x1EA5;t &#x111;a d&#x1EA1;ng, r&#x1EA5;t kh&#xF3; &#x111;&#x1EC3; gom nh&#xF3;m m&#x1ED9;t c&#xE1;ch ch&#xED;nh x&#xE1;c n&#x1EBF;u ch&#x1EC9; ph&#xE2;n ra 10 nh&#xF3;m. Thay v&#xE0;o &#x111;&#xF3; ta c&#xF3; th&#x1EC3; th&#xEA;m c&#xE1;c nh&#xF3;m ph&#x1EE5; nh&#x1B0; s&#x1ED1; 5 nghi&#xEA;n sang tr&#xE1;i, s&#x1ED1; 5 nghi&#xEA;ng sang ph&#x1EA3;i, ... &#x111;&#x1EC3; t&#x103;ng t&#xED;nh hi&#x1EC7;u qu&#x1EA3; trong vi&#x1EC7;c gom nh&#xF3;m. &#x1EDE; &#x111;&#xE2;y, ta s&#x1EBD; th&#x1EED; ch&#x1ECD;n gom th&#xE0;nh 100 nh&#xF3;m kh&#xE1;c nhau v&#x1EDB;i h&#x1EC7; s&#x1ED1; h&#x1ECD;c <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B1;</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span>.
<pre class="lang:Python decode:true">alpha = 0.1
batch_size = 100
output_nodes = 100
</pre>
<h3 id="h&#xE0;m-l&#xE2;n-c&#x1EAD;n-neighborhood">H&#xE0;m l&#xE2;n c&#x1EAD;n (neighborhood)</h3>
Khi c&#x1EAD;p nh&#x1EAD;t tr&#x1ECD;ng s&#x1ED1; c&#x1EE7;a m&#xF4; h&#xEC;nh, ngo&#xE0;i tr&#x1ECD;ng s&#x1ED1; c&#xF3; kho&#x1EA3;ng c&#xE1;ch g&#x1EA7;n nh&#x1EA5;t v&#x1EDB;i gi&#xE1; tr&#x1ECB; d&#x1EEF; li&#x1EC7;u &#x111;ang x&#xE9;t, ta c&#x169;ng c&#x1EA7;n c&#x1EAD;p nh&#x1EAD;t nh&#x1EEF;ng tr&#x1ECD;ng s&#x1ED1; n&#x1EB1;m trong v&#xF9;ng l&#xE2;n c&#x1EAD;n. &#x110;&#x1ECB;nh ngh&#x129;a c&#x1EE7;a <em>l&#xE2;n c&#x1EAD;n</em> &#x1EDF; &#x111;&#xE2;y t&#xF9;y thu&#x1ED9;c v&#xE0;o m&#x1ED7;i ng&#x1B0;&#x1EDD;i, c&#xF3; th&#x1EC3; l&#xE0; 4 &#xF4; xung quanh ho&#x1EB7;c 8 &#xF4; xung quanh.
<pre class="lang:Python decode:true">def neighborhood(i):
    result = [i]
    x, y = i // 10, i % 10
    if (x - 1 &gt;= 0):
        result.append(10*(x - 1) + y)
    if (y + 1 &lt; 10):
        result.append(10*x + y + 1)
    if (x + 1 &lt; 10):
        result.append(10*(x + 1) + y)
    if (y - 1 &gt;= 0):
        result.append(10*x + y - 1)
    return result
</pre>
<h3 id="x&#xE2;y-d&#x1EF1;ng-v&#xE0;-hu&#x1EA5;n-luy&#x1EC7;n-m&#xF4;-h&#xEC;nh">X&#xE2;y d&#x1EF1;ng v&#xE0; hu&#x1EA5;n luy&#x1EC7;n m&#xF4; h&#xEC;nh</h3>
Tr&#x1B0;&#x1EDB;c ti&#xEA;n ta kh&#x1EDF;i t&#x1EA1;o trong s&#x1ED1; c&#x1EE7;a m&#xF4; h&#xEC;nh g&#x1ED3;m 10x10 tr&#x1ECD;ng s&#x1ED1; v&#x1EDB;i 784 chi&#x1EC1;u &#x1EE9;ng v&#x1EDB;i 100 &#x111;i&#x1EC3;m tr&#x1ECD;ng t&#xE2;m. &#x110;&#x1EC3; &#x111;&#x1A1;n gi&#x1EA3;n thay v&#xEC; t&#x1EA1;o m&#x1EA3;ng 2 chi&#x1EC1;u 10x10, ta t&#x1EA1;o m&#xF4;t m&#x1EA3;ng m&#x1ED9;t chi&#x1EC1;u g&#x1ED3;m 100 ph&#x1EA7;n t&#x1EED; v&#x1EDB;i 784 chi&#x1EC1;u. H&#xE0;m l&#xE2;n c&#x1EAD;n c&#x169;ng &#x111;&#x1B0;&#x1EE3;c vi&#x1EBF;t &#x111;&#x1EC3; ph&#xF9; h&#x1EE3;p v&#x1EDB;i c&#xE1;ch kh&#x1EDF;i t&#x1EA1;o n&#xE0;y.
<pre class="lang:Python decode:true">W = np.random.rand(output_nodes,784)
</pre>
Ta t&#xED;nh kho&#x1EA3;ng c&#xE1;ch gi&#x1EEF;a c&#xE1;c tr&#x1ECD;ng t&#xE2;m v&#x1EDB;i c&#xE1;c &#x111;i&#x1EC3;m d&#x1EEF; li&#x1EC7;u v&#xE0; t&#xEC;m ta tr&#x1ECD;ng t&#xE2;m c&#xF3; kho&#x1EA3;ng c&#xE1;ch nh&#x1ECF; nh&#x1EA5;t.
<pre class="lang:Python decode:true">data_batch = train[i*batch_size:i*batch_size + batch_size]
distance = np.sum(np.square(data_batch - W), axis=2)
min_nodes = np.argmin(distance, axis=1)
</pre>
Ti&#x1EBF;p &#x111;&#x1EBF;n, ta c&#x1EAD;p nh&#x1EAD;t tr&#x1ECD;ng s&#x1ED1; &#x111;&#x1B0;&#x1EE3;c ch&#x1ECD;n v&#xE0; c&#xE1;c tr&#x1ECD;ng s&#x1ED1; l&#xE2;n c&#x1EAD;n.
<pre class="lang:Python decode:true">for j in range(batch_size):
            neighbor = neighborhood(min_nodes[j])
            for index in neighbor:
                W[index] += alpha*(data_batch[j].reshape(784) -W[index])
</pre>
L&#x1EB7;p l&#x1EA1;i nhi&#x1EC1;u l&#x1EA7;n qu&#xE1; tr&#xEC;nh hu&#x1EA5;n luy&#x1EC7;n.
<pre class="lang:Python decode:true">for epoch in range(5):
    for i in range(500):
        data_batch = train[i*batch_size:i*batch_size + batch_size]
        distance = np.sum(np.square(data_batch - W), axis=2)
        min_nodes = np.argmin(distance, axis=1)
        for j in range(batch_size):
            neighbor = neighborhood(min_nodes[j])
            for index in neighbor:
                W[index] += alpha*(data_batch[j].reshape(784) -W[index])
</pre>
<h3 id="k&#x1EBF;t-qu&#x1EA3;-hu&#x1EA5;n-luy&#x1EC7;n">K&#x1EBF;t qu&#x1EA3; hu&#x1EA5;n luy&#x1EC7;n</h3>
H&#xE0;m chuy&#x1EC3;n &#x111;&#x1ED5;i b&#x1ED9; trong s&#x1ED1; v&#x1EC1; th&#xE0;nh m&#x1ED9;t ma tr&#x1EAD;n h&#xEC;nh &#x1EA3;nh &#x111;&#x1EC3; hi&#x1EC3;n th&#x1ECB; k&#x1EBF;t qu&#x1EA3; hu&#x1EA5;n luy&#x1EC7;n.
<pre>def make_image(W):
    result = np.zeros((W.shape[0] * 28, W.shape[1] * 28))
    for i in range(W.shape[0]):
        for j in range(W.shape[1]):
            for m in range(28):
                for n in range(28):
                    result[i*28 + m][j*28 + n] = W[i][j][m][n]
    return result
</pre>
K&#x1EBF;t qu&#x1EA3; tr&#x1B0;&#x1EDB;c v&#xE0; sau khi hu&#x1EA5;n luy&#x1EC7;n.
<p align="center">
<img src="/images/init.png" alt="" width="300"> - <img src="/images/result.png" alt="" width="300">
</p>
<p>C&#xF3; th&#x1EC3; th&#x1EA5;y k&#x1EBF;t qu&#x1EA3; h&#x1ED9;i t&#x1EE5; v&#x1EC1; kh&#xE1; t&#x1ED1;t d&#xF9; ch&#x1EC9; v&#x1EDB;i 5 epoch. K&#x1EBF;t gi&#xE1; tr&#x1ECB; tr&#x1ECD;ng s&#x1ED1; &#x111;&#xE3; h&#x1ED9;i t&#x1EE5; v&#x1EC1; c&#xE1;c &#x111;i&#x1EC3;m trung t&#xE2;m c&#x1EE7;a c&#xE1;c nh&#xF3;m v&#xE0; th&#x1EC3; hi&#x1EC7;n &#x111;&#x1B0;&#x1EE3;c &#x111;&#x1EB7;c tr&#x1B0;ng c&#x1EE7;a nh&#xF3;m.</p>
<h2 id="&#xE1;p-d&#x1EE5;ng-cho-b&#xE0;i-to&#xE1;n-nh&#x1EAD;n-d&#x1EA1;ng-k&#xFD;-s&#x1ED1;-vi&#x1EBF;t-tay">&#xC1;p d&#x1EE5;ng cho b&#xE0;i to&#xE1;n nh&#x1EAD;n d&#x1EA1;ng k&#xFD; s&#x1ED1; vi&#x1EBF;t tay</h2>
<p>M&#x1EB7;c d&#xF9; m&#xF4; h&#xEC;nh Self Organising Map l&#xE0; m&#xF4;t m&#xF4; h&#xEC;nh gom nh&#xF3;m nh&#x1B0;ng c&#x169;ng c&#xF3; th&#x1EC3; &#xE1;p d&#x1EE5;ng v&#xE0;o cho b&#xE0;i to&#xE1;n nh&#x1EAD;n d&#x1EA1;ng. Sau qu&#xE1; tr&#xEC;nh gom nh&#xF3;m ta &#x111;&#xE3; c&#xF3; &#x111;&#x1B0;&#x1EE3;c gi&#xE1; tr&#x1ECB; trung t&#xE2;m &#x111;&#x1EA1;i di&#x1EC7;n cho t&#x1EEB;ng nh&#xF3;m. T&#x1EEB; &#x111;&#xE2;y ta c&#xF3; th&#x1EC3; &#xE1;p d&#x1EE5;ng Nearest Neighbor &#x111;&#x1EC3; ti&#x1EBF;n h&#xE0;nh ph&#xE2;n l&#x1EDB;p. Khi m&#x1ED9;t m&#x1EAB;u d&#x1EEF; li&#x1EC7;u m&#x1EDB;i v&#xE0;o, ta s&#x1EBD; so s&#xE1;nh n&#xF3; v&#x1EDB;i c&#xE1;c gi&#xE1; tr&#x1ECB; &#x111;&#x1EA1;i di&#x1EC7;n c&#x1EE7;a nh&#xF3;m. Nh&#x1EEF;ng nh&#xF3;m g&#x1EA7;n v&#x1EDB;i gi&#xE1; tr&#x1ECB; m&#x1EAB;u d&#x1EEF; li&#x1EC7;u nh&#x1EA5;t s&#x1EBD; quy&#x1EBF;t &#x111;&#x1ECB;nh nh&#xE3;n c&#x1EE7;a m&#x1EAB;u d&#x1EEF; li&#x1EC7;u &#x111;&#xF3;. Vi&#x1EC7;c ch&#x1ECD;n s&#x1ED1; l&#x1B0;&#x1EE3;ng nh&#xF3;m s&#x1EBD; &#x1EA3;nh h&#x1B0;&#x1EDF;ng t&#xED;nh hi&#x1EC7;u qu&#x1EA3; c&#x1EE7;a vi&#x1EC7;c gom nh&#xF3;m n&#xEA;n t&#x1EEB; &#x111;&#xF3; c&#x169;ng &#x1EA3;nh h&#x1B0;&#x1EDF;ng &#x111;&#x1EBF;n hi&#x1EC7;u qu&#x1EA3; c&#x1EE7;a vi&#x1EC7;c ph&#xE2;n l&#x1EDB;p. N&#x1EBF;u ch&#x1EC9; ph&#xE2;n th&#xE0;nh 10 nh&#xF3;m, &#x111;&#x1ED9; ch&#xED;nh x&#xE1;c c&#xF3; th&#x1EC3; ch&#x1EC9; &#x111;&#x1B0;&#x1EE3;c 50% nh&#x1B0;ng n&#x1EBF;u ph&#xE2;n th&#xE0;nh 100 nh&#xF3;m, &#x111;&#x1ED9; ch&#xED;nh x&#xE1;c c&#xF3; th&#x1EC3; l&#xEA;n &#x111;&#x1EBF;n 80%.</p>
<p>B&#xE0;i vi&#x1EBF;t tham kh&#x1EA3;o t&#x1EEB; c&#xE1;c ngu&#x1ED3;n</p>
<p>https://en.wikipedia.org/wiki/Self-organizing_map</p>
</div></div><div class="post-main post-comment"><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'lqan';
var disqus_identifier = '2018/05/28/kohonen-network/';
var disqus_title = 'Mạng Nơ-ron tự tổ chức (Mạng Kohonen) - Self Organising Map';
var disqus_url = 'http://yoursite.com/2018/05/28/kohonen-network/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"/><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>